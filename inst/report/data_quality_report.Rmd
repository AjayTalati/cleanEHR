---
title: Data Quality Report
---

# Data Summary
```{r, echo=FALSE}
dp <- total.data.point(ccd)
np <- max(ccd@infotb$pid, na.rm=T)
```

This database contains **`r ccd@nepisodes`** episode data from 
**`r length(unique(ccd@infotb$site_id)) - 1`** sites. Based on the NHS numbers and
PAS numbers, we can identify **`r np`** unique patients, among which the earliest
admission is `r min(ccd@infotb$t_admission, na.rm=T)` and the latest discharge time is
`r max(ccd@infotb$t_discharge, na.rm=T)`. There are `r dp `
total data points found in the current database, which makes in average
`r round(dp/np)` per unique patient. 

## Site Reference
```{r, echo=FALSE}
pander(site.info()[, 1:3], style="rmarkdown")
```

## The original XML files and parse information
```{r, echo=FALSE, results="asis"}
suppressWarnings(library(pander))
panderOptions("digits", 2) 
panderOptions("table.split.table", Inf)
if (!exists("demg")) demg <- demographic.patient.spell(ccd)
fs <- file.summary(ccd)
pander(fs[, c("File", "Number of Episode", "Sites"), with=F])
```

```{r fig.width=15, fig.height=10, echo=FALSE}
xml.file.duration.plot(ccd)
```
```{r fig.width=15, fig.height=10, echo=FALSE}
xml.site.duration.plot(ccd)
```
\newpage

```{r, echo=FALSE, results="asis"}
table1(demg, c("SEX", "ETHNIC", "LOCA", "DIS", "HDIS"))
```
# Completeness
## Demographic data completeness
```{r, echo=FALSE, warning=FALSE, results="asis"}
demographic.data.completeness(demg)
```
## Selected demographic data by site


\newpage
```{r, echo=FALSE, results="asis", warning=FALSE}
demg.distribution(demg, c("HCM", "apache_score"))
```

